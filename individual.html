<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fita</title>
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/individual.css">
</head>

<body>
<div class="container-tab">
    <div id="titulo-fita">
        <p class="title"> <a href="index.html">FITA</a></p>
</div>
    <div id="button-container">
        <hr>
        <div id="teste">
         <a href="Arquivo.html">Arquivo</a>
         <a href="Sobre.html">Sobre</a>
        </div>
        <hr>
    </div>
    <hr id="linha-mobile">
</div>

<h3 id="movie-details-titles1"></h3> 


<div id="meuCarrossel" class="carousel slide" data-ride="carousel">
 
    <div class="carousel-inner">
        <div class="carousel-item active">
            
            <img id="movie-details-photo1" class="d-block w-100" alt="Imagem 1">
       
        </div>
        <div class="carousel-item">
            <img id="movie-details-photo2" class="d-block w-100" alt="Imagem 2">
            
        </div>
        <div class="carousel-item">
            <img id="movie-details-photo3" class="d-block w-100" alt="Imagem 1">

        </div>
 
</div>

<div class="container-info">
    <div id="info-texto">
        <h4>Título:</h4> <span id="movie-details-title"></span><br>
        <h4>Ano:</h4> <span id="movie-details-ano"></span><br>
        <h4>Duração:</h4> <span id="movie-details-duracao"></span><br>
        <h4>Género:</h4> <span id="movie-details-genero"></span><br>
        <h4>Realização:</h4> <span id="movie-details-realizacao"></span><br><br><br>
        <h4>Descrição:</h4> <span id="movie-details-descricao"></span><br>
        <br><br>
        <h4>Disponível em:</h4> <p><span id="movie-details-plataformas"></span></p><br>
    </div>

    <div id="info-imagem">
        <img class="imagem-item" id="movie-details-photo">
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
    // Extract the movie slug from the URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const movieSlug = urlParams.get('slug');
    console.log('Movie Slug:', movieSlug);

    // Fetch data from the API using the extracted slug
    const url = `https://api.cosmicjs.com/v3/buckets/fita-production/objects/${movieSlug}?read_key=nMpklsOUy4PFd7cy1DtpXwvKDAst2IXyCGC4I4x2cDynYnbkUF&depth=1&props=slug,title,metadata`;
    console.log(url);

    fetch(url)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('API Response:', data);

            // Check if the data has the expected structure
            if (data.object && data.object.metadata) {
                const movieData = data.object.metadata;

                // Update movie details on the page
                document.getElementById('movie-details-photo').src = movieData.photo.url;
                document.getElementById('movie-details-title').textContent = data.object.title;
                document.getElementById('movie-details-titles1').textContent = data.object.title;

                document.getElementById('movie-details-ano').textContent = movieData.ano;

                document.getElementById('movie-details-duracao').textContent = movieData.duracao;
                document.getElementById('movie-details-genero').textContent = movieData.genero.value; // Updated line
                document.getElementById('movie-details-realizacao').textContent = movieData.realizacao;
                document.getElementById('movie-details-descricao').textContent = movieData.descricao;
                document.getElementById('movie-details-plataformas').textContent = movieData.plataformas;
                document.getElementById('movie-details-photo1').src = movieData.photo1.url;
                document.getElementById('movie-details-photo2').src = movieData.photo2.url;
                document.getElementById('movie-details-photo3').src = movieData.photo3.url;
            } else {
                throw new Error('Invalid API response structure or movie not found');
            }
        })
        .catch(error => console.error('Error fetching data:', error));
</script>

</body>
</html>